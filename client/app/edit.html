<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>BB宝</title>

<script src="jquery-1.9.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="styles/webim.css" />
<link rel="stylesheet" type="text/css" href="styles/webimpage.css" />

</head>
<body onselectstart="return false;">
	<div class="wOther"
		style="position: absolute; width: 334px; height: 422px; z-index: 9724;">
		<div class="wContent">
			<div class="wOtherTitle" style="color: rgb(0, 0, 0);" onmousedown="kate.window.drag()">
				<div class="wIcon">
					<img
						src="http://webos.knowledge.com.cn/webim/images/im/toolprofile_s.png">
				</div>
				<div class="wText">编辑个人资料</div>
				<div class="wControl">
					<div class="wControlMin" onmouseover="this.scrollTop='13'"
						onmouseout="this.scrollTop='0'">
						<img
							src="http://webos.knowledge.com.cn/webim/images/im/othercontrolmin.png"
							title="最小化">
					</div>
					<div class="wControlClose" onmouseover="this.scrollTop='15'"
						onmouseout="this.scrollTop='0'">
						<img
							src="http://webos.knowledge.com.cn/webim/images/im/othercontrolclose.png"
							title="关闭" onclick="kate.window.close()">
					</div>
				</div>
			</div>
			<div class="wWindowContent"
				style="background-color: transparent; height: 397px;">
				<form action="profilesave.php" class="profilesave" method="post"
					enctype="multipart/form-data" name="form1">
					<table width="330" border="0" align="center" cellpadding="0"
						cellspacing="0">
						<tbody>
							<tr>
								<td height="15" colspan="3"></td>
							</tr>
							<td height="25" align="right">新密码：</td>
							<td align="left">&nbsp;</td>
							<td align="left"><input id="tbPass" type="password"
								class="input1" maxlength="12" onblur="chkPass()"></td>
							</tr>
							<tr>
								<td height="22" align="right"></td>
								<td align="left">&nbsp;</td>
								<td align="left"><span class="orange">由6～12位字符组成</span></td>
							</tr>
							<tr>
								<td height="25" align="right">重复密码：</td>
								<td align="left">&nbsp;</td>
								<td align="left"><input id="tbRepass" type="password"
									class="input1" maxlength="12"></td>
							</tr>
							<tr>
								<td height="22" align="right"></td>
								<td align="left">&nbsp;</td>
								<td align="left"><span class="orange">由6～12位字符组成</span></td>
							</tr>
							<tr>
								<td height="25" align="right">昵称：</td>
								<td align="left">&nbsp;</td>
								<td align="left"><input id="tbNick" type="text"
									class="input1" maxlength="20"></td>
							</tr>
							<tr>
								<td height="22" align="right"></td>
								<td align="left">&nbsp;</td>
								<td align="left"><span class="orange">由4～40位字符组成</span></td>
							</tr>
							<tr>
								<td height="12" align="right">个性签名：</td>
								<td rowspan="3" align="left">&nbsp;</td>
								<td rowspan="3" align="left"><textarea id="tbSign"
										class="mineinput" style="height: 55px" maxlength="200"></textarea></td>
							</tr>
							<tr>
								<td height="13" align="right"></td>
							</tr>
							<tr>
								<td height="25" align="right"></td>
							</tr>
							<tr>
								<td height="10" align="right"></td>
								<td align="left">&nbsp;</td>
								<td align="left">&nbsp;</td>
							</tr>
							<tr>
								<td height="25" align="right">个人头像：</td>
								<td align="left">&nbsp;</td>
								<td align="left"><iframe id="ifrUpload" frameborder=0
										width=260 height=38 marginheight=0 marginwidth=0 scrolling=no></iframe></td>
							</tr>
							<tr>
								<td height="25" align="right"></td>
								<td align="left">&nbsp;</td>
								<td align="left"><span class="orange">支持jpg、gif、png图片文件</span></td>
							</tr>
							<tr>
								<td height="22" align="right">性别：</td>
								<td align="left">&nbsp;</td>
								<td align="left"><input name="rdGender" type="radio"
									value="1"> <label for="rdMale">男</label> <input
										name="rdGender" type="radio" value="2"> <label
											for="rdFemale">女</label></td>
							</tr>
							<tr>
								<td height="35" align="center"></td>
								<td align="center">&nbsp;</td>
								<td height="35" align="left"><input class="button1"
									type="button" name="btnSubmit" value="确定" onclick="save()">&nbsp;&nbsp;
										<input class="button1" type="button" name="btnCancel"
										onclick="winClose(event);" value="取消"></td>
							</tr>
						</tbody>
					</table>
				</form>
			</div>
		</div>
		<div class="wLoading" style="display: none;">加载中...</div>
	</div>
	<div class="wLoading" style="display: none;">加载中...</div>
	</div>


	<script>
		var user = null;
		var server = null;

		function save() {

			user.nick = jQuery("#tbNick").val();
			user.sign = jQuery("#tbSign").val();

			if (jQuery("#tbRepass").val() != "") {

				if (jQuery("#tbRepass").val() == jQuery("#tbPass").val()) {

					user.password = jQuery("#tbRepass").val();
				} else {
					alert("密码不符")
				}

			}

			user.sex = jQuery("input:radio[name=rdGender]:checked").val();
			kate.parentWindow.call("nodeim.setUser", [ user ]);

			kate.window.hide();
		}

		function onKateLoaded() {
			// 上传文件面板
			user = kate.parentWindow.call("nodeim.getUser", []);
			server = kate.parentWindow.call("nodeim.getServer", []);

			jQuery("#tbNick").val(user.nick);
			jQuery("#tbSign").val(user.sign);

			$('input:radio[name=rdGender]')[Number(user.sex) - 1].checked = true;

			$("#ifrUpload").attr('src',
					server + "/nodeim-server/upload?user=" + user.id);

		}
	</script>
</body>
</html>
